
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="/style.css"/>

<!-- Syntax highlighting -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>

<!-- MathJAX -->
<script>
  MathJax = {
    loader: {
	load: ['[custom]/xypic.js'],
	paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'}
    },
    tex: {
	packages: {'[+]': ['xypic']},
	tags: 'ams',
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        macros: {
            A: '\\mathbb{A}', B: '\\mathbb{B}', C: '\\mathbb{C}', D: '\\mathbb{D}',
            E: '\\mathbb{E}', F: '\\mathbb{F}', G: '\\mathbb{G}', H: '\\mathbb{H}',
            I: '\\mathbb{I}', J: '\\mathbb{J}', K: '\\mathbb{K}', L: '\\mathbb{L}',
            M: '\\mathbb{M}', N: '\\mathbb{N}', O: '\\mathbb{O}', P: '\\mathbb{P}',
            Q: '\\mathbb{Q}', R: '\\mathbb{R}', S: '\\mathbb{S}', T: '\\mathbb{T}',
            U: '\\mathbb{U}', V: '\\mathbb{V}', W: '\\mathbb{W}', X: '\\mathbb{X}',
            Y: '\\mathbb{Y}', Z: '\\mathbb{Z}', RP: '\\mathbb{RP}', CP: '\\mathbb{CP}',

	    cA: '\\mathcal{A}', cB: '\\mathcal{B}', cC: '\\mathcal{C}', cD: '\\mathcal{D}',
            cE: '\\mathcal{E}', cF: '\\mathcal{F}', cG: '\\mathcal{G}', cH: '\\mathcal{H}',
            cI: '\\mathcal{I}', cJ: '\\mathcal{J}', cK: '\\mathcal{K}', cL: '\\mathcal{L}',
            cM: '\\mathcal{M}', cN: '\\mathcal{N}', cO: '\\mathcal{O}', cP: '\\mathcal{P}',
            cQ: '\\mathcal{Q}', cR: '\\mathcal{R}', cS: '\\mathcal{S}', cT: '\\mathcal{T}',
            cU: '\\mathcal{U}', cV: '\\mathcal{V}', cW: '\\mathcal{W}', cX: '\\mathcal{X}',
            cY: '\\mathcal{Y}', cZ: '\\mathcal{Z}',

	    fa: '\\mathfrak{a}', fb: '\\mathfrak{b}', fp: '\\mathfrak{p}', fm: '\\mathfrak{m}',
	    fM: '\\mathfrak{M}',

            bf: ['\\mathbf{#1}', 1], 
	    x: '\\mathbf{x}', y: '\\mathbf{y}', w: '\\mathbf{w}', Bb: '\\mathbf{b}',
	    i: '\\imath', j: '\\jmath', v: '\\mathbf{v}', w: '\\mathbf{w}',

	    a: '\\alpha', b: '\\beta', g: '\\gamma', e: '\\epsilon', l: '\\lambda',

	    id: '\\mathop{\\rm id}', span: '\\mathop{\\rm span}', im: '\\mathop{\\rm im}', sgn: '\\mathop{\\rm sgn}',
	    End: '\\mathop{\\rm End}', Gal: '\\mathop{\\rm Gal}', Hom: '\\mathop{\\rm Hom}', Inn: '\\mathop{\\rm Inn}',
	    Out: '\\mathop{\\rm Out}', spec: '\\mathop{\\rm Spec}', colim: '\\mathop{\\rm colim}', Ob: '\\mathop{\\rm Ob}',
	    Cn: '\\mathop{\\rm Cn}', Th: '\\mathop{\\rm Th}', Spec: '\\mathop{\\rm Spec}', halo: '\\mathop{\\rm halo}',
	    st: '\\mathop{\\rm st}', inte: '\\mathop{\\rm int}', trdeg: '\\mathop{\\rm tr.deg}', rank: '\\mathop{\\rm rank}',
	    nullity: '\\mathop{\\rm nullity}', Aut: '\\mathop{\\rm Aut}', ann: '\\mathop{\\rm ann}', max: '\\mathop{\\rm max}',
	    min: '\\mathop{\\rm min}', Re: '\\mathop{\\rm Re}', Im: '\\mathop{\\rm Im}', char: '\\mathop{\\rm char}',

	    Set: '\\mathbf{Set}', Top: '\\mathbf{Top}', HTop: '\\mathbf{HTop}', Grp: '\\mathbf{Grp}', Ab: '\\mathbf{Ab}',
	    and: '\\quad\\text{and}\\quad', or: '\\quad\\text{or}\\quad',

	    nin: '\\not\\in', s: '\\subset', seq: '\\subseteq', ss: '\\supset', Seq: '\\supseteq',
	    inv: '{}^{-1}',
	    ol: '\\overline',
	    qed: '\\blacksquare',
	    hR: '{}^*\\R',
	    normal: '\\triangleleft', Normal: '\\triangleright',
	    normaleq: '\\trianglelefteq', Normaleq: '\\trianglerighteq',
	    dlim: '\\varinjlim',
	    invlim: '\\varprojlim',
	    imp: '\\Rightarrow',
	    impd: '\\Leftarrow',
	    eq: ['\\begin{equation}#1\\end{equation}', 1],
	    ZZ: ['\\Z/{#1}\\Z', 1],
	    ZZs: ['(\\Z/{#1}\\Z)^*', 1],
	    legendre: ['\\left(\\frac{#1}{#2}\\right)', 2],
	    d: '\\mathop{}\\!\\mathrm{d}',
	    p: '\\partial',
	    pp: ['{\\p #1\\over\\p #2}', 2],
	    ppp: ['{\\p^2 #1\\over\\p #2\\p #3}', 3],
	    angles: ['\\langle{#1}\\rangle', 1],
	    norm: ['\\left\\Vert{#1}\\right\\Vert', 1],
	    floor: ['\\left\\lfloor{#1}\\right\\rfloor', 1],
	    ceil: ['\\left\\lceil{#1}\\right\\rceil', 1],
        },
    },
    chtml: {
	scale: 0.85,
	linebreaks: {
	    automatic: true
	}
    }
};
</script>

<script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

  </head>

  <body>
    <a href="/index.html">&lt; Back</a> 

    <h1 id="generating-finite-rings">Generating finite rings</h1>
<p><em>Note: To be clear, the definition of ring I'm using includes the
multiplicative identity 1.</em></p>
<p>A while back I wrote a program to exhaustively generate all finite
rings of some given order $n$. This post shares the ideas that went
into that.</p>
<p>In a computer, a ring of order $n$ can be represented as a pair
consisting of an addition table and a multiplication table, each of
the tables being $n\times n$. One could then generate the rings by
brute force: iterate through all possible pairs of tables and check
which ones satisfy the ring axioms. However, the number of pairs of
tables, as a function of $n$, is</p>
<p>$$\left(n^{n^2}\right)^2 = n^{2n^2}.$$</p>
<p>For $n=3$ the computation is already infeasible. Luckily there are
optimizations that can be made.</p>
<p>One easy observation is that by the classification of finite abelian
groups (FAGs), all the valid addition tables are already known. If $G$
is the additive group of an order $n$ ring, then</p>
<p>$$\begin{equation}
\label{eq:decompose}
G \cong \bigoplus_i\Z_{d_i}\ ,\quad\text{where $d_{i+1}\mid d_i$
and $\prod_i d_i=n$}.
\end{equation}$$</p>
<p>The $d_i$'s are called <em>invariant factors</em>. So the problem reduces to
generating valid multiplication tables for a given addition able.</p>
<p>Another observation is that the multiplication table is fully
determined by its restriction to a set of generators for $G$. The rest
of the table can be determined using the distributive law and the
addition table. For instance, if $g_1$ and $g_2$ are two generators
for $G$, then we can determine the product of $2g_1+g_2$ and
$g_1+2g_2$ as follows:</p>
<p>$$(2g_1+g_2)(g_1+2g_2) =
({g_1}^2+{g_1}^2)+(g_1g_2+g_1g_2+g_1g_2+g_1g_2)+g_2g_1+({g_2}^2+{g_2}^2).$$</p>
<p>Thus it suffices to specify the products ${g_1}^2$, $g_1g_2$, $g_2g_1$
and ${g_2}^2$. This reduces the number of multiplication tables that
need to be checked to</p>
<p>$$n^{g^2},\ \text{where $g$ is the number of generators.}$$</p>
<p>Clearly it is desirable to minimise $g$. For example, looking at the
additive group</p>
<p>$$\Z_4\oplus\Z_3\oplus\Z_2,$$</p>
<p>one's first instinct might be to consider the generators $(1,0,0)$,
$(0,1,0)$ and $(0,0,1)$, in which case $g=3$. But this is not the
minimum, for we have</p>
<p>$$\Z_4\oplus\Z_3\oplus\Z_2 \cong \Z_{12}\oplus\Z_2,$$</p>
<p>and the RHS can obviously be generated by 2 elements. We can't reduce
$g$ to 1 since $\Z_{12}\oplus\Z_2$ is not cyclic, and so $g=2$ is the
minimum. Note that when the minimum was attained, $\Z_{12}\oplus\Z_2$
was is in the form of \eqref{eq:decompose}; in general, the minimal
number of generators is the number of (non-unit) invariant
factors. This can actually be proved quite generally for finitely
generated modules over a PID, of which FAGs are a specific example.</p>
<p><strong>Proposition.</strong> Let $M$ be a fg module over a PID $D$. The minimum
number of generators $g$ for $M$ is equal to the number of
(non-unit) invariant factors, $k$.</p>
<p><em>Proof.</em> Note that $g$ exists and is finite since $M$ is fg. On one
hand we have $g\le k$ because given the decomposition $M\cong
\bigoplus_{i=1}^k D/(d_i)$ where none of the $d_i$'s are units, there
is an obvious generating set of size $k$. On the other hand, $M$ can
be realised as a quotient $D^g/K$, and $K$ can be associated with an
$n\times g$ matrix $A$, where $n\le g$ and the rows of $A$ generate
$K$. The diagonal entries of the Smith normal form of $A$ consist of
the invariant factors of $D^g/K$, of which there are $\le g$ of
them. $\qed$</p>
<p>From now on I'll use $g$ to denote the minimum number of generators
for a given FAG $G$. Furthermore, I will think of elements of $G$ as
tuples in the direct sum decomposition $\bigoplus_i\Z_{d_i}$, and I
will fix the generators $e_1,\ldots,e_g$, where $e_i$ refers to the
tuple with $1$ at the $i$th component and 0 everywhere else. Let's
take a moment to examine how the maximum of $g$ across all order $n$
FAGs changes with $n$. This is quite important, since the FAG with the
largest $g$ will take up the vast majority of computing time in
finding rings.</p>
<p>Consider a FAG with a large number of invariant factors. If $p$ is a
prime dividing the smallest invariant factors, then it divides all of
them, thus the multiplicity of $p$ in $n$ is very large. On the flip
side, if the multiplicity of $p$ in $n$ is large, say $n=p^ka$ for
large $k$ and $p\nmid a$, then we can exhibit an order $n$ FAG with
many invariant factors, namely</p>
<p>$$\Z_{ap}\oplus\Z_p^{k-1}.$$</p>
<p>Thus, we see that the total number of multiplication tables depends
greatly on the sizes of the multiplicies in the prime factorisation of
$n$. This also supports the observation that rings with 'small'
factorisations are easier to classify.</p>
<p>So far we've only talked about the additive structure, but further
optimisations can be made if we consider the multiplicative structure
too. First, note that the multiplicative identity 1 must have additive
order $d_1$ (the largest invariant factor). For if the order is say
$n$ and it is $&lt; d_1$, then for each $r$ in the ring we have</p>
<p>$$\underbrace{r+\ldots+r}_\text{$n$ times} =
\underbrace{(1+\ldots+1)}_\text{$n$ times}\cdot r = 0r = 0,$$</p>
<p>so every element has additive order $&lt; d_1$. But this cannot be true
because the element $e_1$ has additive order $d_1$!</p>
<p>The question is, which order $d_1$ element can 1 be? The answer is, we
can set it to be the tuple $e_1$ without any loss of generality! (I
prove this below). Therefore, the products $e_1e_k$ and $e_ke_1$ are
known a priori for all $k$, and only $(g-1)^2$ products of the
generators remain to be specified. Hence the number of multiplication
tables reduces to</p>
<p>$$n^{(g-1)^2}.$$</p>
<p>I will now justify why $e_1$ can be used as 1. A priori, we only know
that 1 has order $d_1$ in $G$. Thus, it has the form
$(x_1,\ldots,x_g)$ where $x_1$ is a generator of $\Z_{d_1}$ and the
rest are arbitrary. But then $G$ can be written as an internal direct
sum</p>
<p>$$\angles{(x_1,\ldots,x_g)}\oplus \angles{e_2}\oplus \cdots\oplus
\angles{e_g},$$</p>
<p>where the $i$th summand is isomorphic to $\Z_{d_i}$. We can thus
represent elements of $G$ as tuples with respect to this internal
direct sum, in which $e_1$ now corresponds to 1.</p>
<p>There is one last optimisation that I thought of but haven't
implemented yet. Given $j,k$ satisfying $1&lt;i\le j\le g$, we have that
$e_i$ and $e_j$ have additive orders $d_i$ and $d_j$
respectively. Thus the additive order of the products $e_ie_j$ and
$e_je_i$ must divide $(d_i,d_j)=d_j$. This implies that the products
must belong in the subgroup</p>
<p>$$\underbrace{\Z_{d_j}\oplus\cdots\oplus\Z_{d_j}}_\text{$j$ times}\oplus
\Z_{d_{j+1}}\oplus\cdots\Z_{d_g} \le \bigoplus_i\Z_{d_i},$$</p>
<p>which is precisely the subgroup of elements with order dividing
$d_j$. In practise I don't think this is a significant optimization.</p>
<h3 id="addendum-classifying-order-p-and-p-2-rings">Addendum: classifying order $p$ and $p^2$ rings</h3>
<p><strong>Lemma.</strong> The only ring with cyclic additive group $\Z_n$ is $\ZZ n$.</p>
<p><em>Proof.</em> Such a ring's multiplicative structure is completely
determined by the product of the generator $1\in\Z_n$ with itself. By
the remarks above we can assume WLOG that 1 is also the
multiplicative identity, in which case we are forced to have
$1\cdot1=1$, giving rise to the ring $\ZZ n$. $\qed$</p>
<p><strong>Corollary.</strong> The only order $p$ ring is $\F_p$.</p>
<p><strong>Proposition.</strong> The only order $p^2$ rings are $\ZZ{p^2}$,
$\F_p\times\F_p$, $\F_{p^2}$ and $\F_p[x]/(x^2)$.</p>
<p><em>Proof.</em> Either the additive group is cyclic in which case the ring is
$\ZZ{p^2}$, or the additive group is $\Z_p\oplus\Z_p$. We can assume
that $(0,1)$ is the multiplicative identity, in which case the
multiplicative structure is completely determined by the product
$(1,0)(1,0)$. If $(1,0)^2=(a,b)$, then the ring can be modelled as a quotient</p>
<p>$$\F_p[x]/(x^2-ax-b),$$</p>
<p>where $(0,1)$ and $(1,0)$ correspond to 1 and $x$ respectively. There
are 3 possibilities depending on the behaviour of $p(x)=x^2-ax-b$:</p>
<ol>
<li>
<p>$p(x)$ splits into 2 distinct linear factors $(x-\alpha)$ and $(x-\beta)$, in which case</p>
<p>$$\F_p[x]/(x^2-ax-b) \cong \F_p[x]/(x-\alpha) \times
\F_p[x]/(x-\beta) \cong \F_p\times\F_p.$$</p>
</li>
<li>
<p>$p(x)=(x-\alpha)^2$, in which csae there is an isomorphism</p>
<p>$$\begin{matrix}
\F_p[x]/(x^2) &amp; \to &amp; \F_p[x]/(x-\alpha)^2 \\
\overline x &amp; \mapsto &amp; \overline{x-\alpha}
\end{matrix}$$</p>
</li>
<li>
<p>$p(x)$ is irreducible, in which case the ring is $\F_{p^2}$. $\qed$</p>
</li>
</ol>
<div class="footnote">
</div>

  </body>
</html>

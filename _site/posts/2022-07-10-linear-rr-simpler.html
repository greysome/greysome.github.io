
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="/style.css"/>

<!-- Syntax highlighting -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>

<!-- JQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        crossorigin="anonymous"></script>

<!-- MathJAX -->
<script>
  MathJax = {
    loader: {
	load: ['[custom]/xypic.js'],
	paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'}
    },
    tex: {
	packages: {'[+]': ['xypic']},
	tags: 'ams',
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        macros: {
            A: '\\mathbb{A}', B: '\\mathbb{B}', C: '\\mathbb{C}', D: '\\mathbb{D}',
            E: '\\mathbb{E}', F: '\\mathbb{F}', G: '\\mathbb{G}', H: '\\mathbb{H}',
            I: '\\mathbb{I}', J: '\\mathbb{J}', K: '\\mathbb{K}', L: '\\mathbb{L}',
            M: '\\mathbb{M}', N: '\\mathbb{N}', O: '\\mathbb{O}', P: '\\mathbb{P}',
            Q: '\\mathbb{Q}', R: '\\mathbb{R}', S: '\\mathbb{S}', T: '\\mathbb{T}',
            U: '\\mathbb{U}', V: '\\mathbb{V}', W: '\\mathbb{W}', X: '\\mathbb{X}',
            Y: '\\mathbb{Y}', Z: '\\mathbb{Z}', RP: '\\mathbb{RP}', CP: '\\mathbb{CP}',

	    cA: '\\mathcal{A}', cB: '\\mathcal{B}', cC: '\\mathcal{C}', cD: '\\mathcal{D}',
            cE: '\\mathcal{E}', cF: '\\mathcal{F}', cG: '\\mathcal{G}', cH: '\\mathcal{H}',
            cI: '\\mathcal{I}', cJ: '\\mathcal{J}', cK: '\\mathcal{K}', cL: '\\mathcal{L}',
            cM: '\\mathcal{M}', cN: '\\mathcal{N}', cO: '\\mathcal{O}', cP: '\\mathcal{P}',
            cQ: '\\mathcal{Q}', cR: '\\mathcal{R}', cS: '\\mathcal{S}', cT: '\\mathcal{T}',
            cU: '\\mathcal{U}', cV: '\\mathcal{V}', cW: '\\mathcal{W}', cX: '\\mathcal{X}',
            cY: '\\mathcal{Y}', cZ: '\\mathcal{Z}',

	    fa: '\\mathfrak{a}', fb: '\\mathfrak{b}', fp: '\\mathfrak{p}', fm: '\\mathfrak{m}',
	    fM: '\\mathfrak{M}',

            bf: ['\\mathbf{#1}', 1], 
	    x: '\\mathbf{x}', y: '\\mathbf{y}', w: '\\mathbf{w}', Bb: '\\mathbf{b}',
	    i: '\\imath', j: '\\jmath', v: '\\mathbf{v}', w: '\\mathbf{w}',

	    a: '\\alpha', b: '\\beta', g: '\\gamma', e: '\\epsilon', l: '\\lambda',

	    id: '\\mathop{\\rm id}', span: '\\mathop{\\rm span}', im: '\\mathop{\\rm im}', sgn: '\\mathop{\\rm sgn}',
	    End: '\\mathop{\\rm End}', Gal: '\\mathop{\\rm Gal}', Hom: '\\mathop{\\rm Hom}', Inn: '\\mathop{\\rm Inn}',
	    Out: '\\mathop{\\rm Out}', spec: '\\mathop{\\rm Spec}', colim: '\\mathop{\\rm colim}', Ob: '\\mathop{\\rm Ob}',
	    Cn: '\\mathop{\\rm Cn}', Th: '\\mathop{\\rm Th}', Spec: '\\mathop{\\rm Spec}', halo: '\\mathop{\\rm halo}',
	    st: '\\mathop{\\rm st}', inte: '\\mathop{\\rm int}', trdeg: '\\mathop{\\rm tr.deg}', rank: '\\mathop{\\rm rank}',
	    nullity: '\\mathop{\\rm nullity}', Aut: '\\mathop{\\rm Aut}', ann: '\\mathop{\\rm ann}', max: '\\mathop{\\rm max}',
	    min: '\\mathop{\\rm min}', Re: '\\mathop{\\rm Re}', Im: '\\mathop{\\rm Im}', char: '\\mathop{\\rm char}',

	    Set: '\\mathbf{Set}', Top: '\\mathbf{Top}', HTop: '\\mathbf{HTop}', Grp: '\\mathbf{Grp}', Ab: '\\mathbf{Ab}',

  and: '\\quad\\text{and}\\quad', or: '\\quad\\text{or}\\quad',

	    nin: '\\not\\in', s: '\\subset', seq: '\\subseteq', ss: '\\supset', Seq: '\\supseteq',
	    inv: '{}^{-1}',
	    ol: '\\overline',
	    qed: '\\blacksquare',
	    hR: '{}^*\\R',
	    normal: '\\triangleleft', Normal: '\\triangleright',
	    normaleq: '\\trianglelefteq', Normaleq: '\\trianglerighteq',
	    dlim: '\\varinjlim',
	    invlim: '\\varprojlim',
	    imp: '\\Rightarrow',
	    impd: '\\Leftarrow',
	    eq: ['\\begin{equation}#1\\end{equation}', 1],
	    ZZ: ['\\Z/{#1}\\Z', 1],
	    ZZs: ['(\\Z/{#1}\\Z)^*', 1],
	    legendre: ['\\left(\\frac{#1}{#2}\\right)', 2],
	    d: '\\mathop{}\\!\\mathrm{d}',
	    p: '\\partial',
	    pp: ['{\\p #1\\over\\p #2}', 2],
	    ppp: ['{\\p^2 #1\\over\\p #2\\p #3}', 3],
	    angles: ['\\langle{#1}\\rangle', 1],
	    norm: ['\\left\\Vert{#1}\\right\\Vert', 1],
	    floor: ['\\left\\lfloor{#1}\\right\\rfloor', 1],
	    ceil: ['\\left\\lceil{#1}\\right\\rceil', 1],
        },
    },
    chtml: {
	scale: 0.85,
	linebreaks: {
	    automatic: true
	}
    }
};
</script>

<script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

</head>
<body>
<a href="/index.html">&lt; Back</a> 
<h1>A simpler way of solving linear recurrences</h1>
<p>The standard method involves diagonalisation and Jordan normal form
(in the separable and non-separable case respectively). However a
problem sent by a friend in Discord prompted me to figure out a less
sophisticated but frankly more elegant and illuminating method.</p>
<p>Let</p>
<p>$$a_{n+k}=c_{k-1}a_{n+k-1}+c_{k-2}a_{n+k-2}+\ldots+c_0a_n$$</p>
<p>be our $k$th order homogeneous linear recurrence with complex
coefficients. A <em>solution</em> is simply taken to be a sequence $\{a_n\}$
satisfying the recurrence, and its first $k$ terms are the <em>initial
conditions</em>. Clearly every choice of initial conditions induces a
unique solution, and so we have an isomorphism of vector spaces</p>
<p>$$\begin{matrix}
T & : & \{\text{initial conditions}\} & \to & \{\text{solutions}\} \\
&& \cong & & \cong \\
&& \C^k & & \text{a subspace of $\C^\omega$}
\end{matrix}$$</p>
<p>(Crucially, the solutions form a vector space because the recurrence
is linear.) To solve the recurrence, we will find a convenient basis
$B$ of initial conditions whose solutions have a nice closed form, so
that by passage through $T$, every solution is a linear combination of
these closed forms.</p>
<h3>Separable case</h3>
<p>Let $\lambda_1,\ldots,\lambda_k$ be the $k$ distinct roots of the charpoly</p>
<p>$$p(\lambda)=\lambda^k-c_{k-1}\lambda^{k-1}-\ldots-c_0.$$</p>
<p>For each $\lambda_i$ we can generate the initial condition
$(1,\lambda_i,\cdots,\lambda_i^{k-1})$, whose image under $T$ is the
sequence $\{\lambda_i^n\}$ (since successive powers of $\lambda_i$
always satisfy the recurrence). Furthermore these $k$ initial
conditions form a basis since the determinant of the corresponding
Vandermonde matrix</p>
<p>$$\begin{pmatrix}
1 & \lambda_1 & \cdots & \lambda_1^{k-1} \\
1 & \lambda_2 & \cdots & \lambda_2^{k-1} \\
& & \vdots & \\
1 & \lambda_k & \cdots & \lambda_k^{k-1} \\
\end{pmatrix}$$</p>
<p>is nonzero. Thus every solution $\{a_n\}$ has the form</p>
<p>$$a_n = A_1\lambda_1^n+\ldots+A_k\lambda_k^n.$$</p>
<p>I love this proof more than the diagonalisation proof because it makes
the role of the charpoly transparent: their roots just happen to
provide the simplest closed-form solutions.</p>
<h3>Non-separable case</h3>
<p>Let $\lambda_1,\ldots,\lambda_l$ be the roots with multiplicities
$m_1,\ldots,m_l$. Unfortunately the $l$ initial conditions
$(1,\lambda_i,\ldots,\lambda_i^{k-1})$ are not enough to form a basis,
so we need to find more initial conditions with easy-to-express
solutions. This is done by considering successive derivatives of
$p(\lambda)$, courtesy of the following result which is given without
proof.</p>
<p><strong>Lemma.</strong> If $\lambda$ is a root of $p$ with multiplicity $m$, then
$\lambda$ is also a root of
$p'(\lambda)$, $p''(\lambda)$, $\ldots$ , $p^{(m-1)}(\lambda)$.</p>
<p>So for each root $\lambda_i$, we can generate $m_i-1$ more initial
conditions by multiplying the equation
$\lambda_i^k=c_{k-1}\lambda_i^{k-1}+\ldots+c_0$ by powers of
$\lambda_i$ and then differentiating up to $m-1$ times:</p>
<p>$$\begin{align*}
\lambda_i^{k+n}&=c_{k-1}\lambda_i^{k+n-1}+c_{k-2}\lambda_i^{k+n-2}+\ldots+c_1\lambda_i^{n+1}+c_0\lambda_i^n, \\
(k+n)\lambda_i^{k+n-1}&=c_{k-1}\bigl((k+n-1)\lambda_i^{k+n-2}\bigr)+c_{k-2}\bigl((k+n-2)\lambda_i^{k+n-3}\bigr)+\ldots \\
&\qquad+c_1\bigr((n+1)\lambda_i^n\bigr)+c_0(n\lambda_i^{n-1}), \\
(k+n)(k+n-1)\lambda_i^{k+n-2}&=c_{k-1}\bigl((k+n-1)(k+n-2)\lambda_i^{k+n-3}\bigr)+c_{k-2}\bigl((k+n-2)(k+n-3)\lambda_i^{k+n-4}\bigr)+\ldots \\
&\qquad+c_1\bigr((n+1)n\lambda_i^{n-1}\bigr)+c_0(n(n-1)\lambda_i^{n-2}), \\
&\vdots
\end{align*}$$</p>
<p>Thus we see that the initial conditions</p>
<p>$$\begin{align*}
&(1,\ \lambda_i,\ \lambda_i^2,\ \ldots,\  \lambda_i^{k-1}), \\
&(1,\ 2\lambda_i,\ 3\lambda_i^2,\ \ldots,\  k\lambda_i^{k-1}), \\
&(2,\ 6\lambda_i,\ 12\lambda_i^2,\ \ldots,\ k(k+1)\lambda_i^{k-1}), \\
&(6,\ 24\lambda_i,\ 60\lambda_i^2,\ \ldots,\ k(k+1)(k+2)\lambda_i^{k-1}), \\
&\qquad\vdots \\
&\bigl((m_i-1)!,\ {m_i!\over1!}\lambda_i,\ {(m_i+1)!\over2!}\lambda_i^2,\ \ldots,\ {(m_i+k-2)!\over(k-1)!}\lambda_i^{k-1}\bigr)
\end{align*}$$</p>
<p>correspond to the solutions</p>
<p>$$\bigl\{\lambda_i^n\bigr\},\;\bigl\{(n+1)\lambda_i^n\bigr\},\;\bigl\{(n+1)(n+2)\lambda_i^n\bigr\},\;\ldots,\;\bigl\{(n+1)(n+2)\cdots(n+m_i-1)\lambda_i^n\bigr\}.$$</p>
<p>So each root $\lambda_i$ generates $m_i$ initial conditions, and we have a tentative basis of $k$ elements. We just need to show that it is linearly independent to conclude that every solution has the form</p>
<p>$$\begin{matrix}
a_n & = & A_{1,1}\lambda_1^n & + & A_{1,2}(n+1)\lambda_1^n & + & \cdots & + & A_{1,m_1}(n+1)\cdots(n+m_1-1)\lambda_1^n \\
& + & A_{2,1}\lambda_2^n & + & A_{2,2}(n+1)\lambda_2^n & + & \cdots & + & A_{2,m_2}(n+1)\cdots(n+m_2-1)\lambda_2^n \\
& + & \cdots \\
& + & A_{l,1}\lambda_l^n & + & A_{l,2}(n+1)\lambda_l^n & + & \cdots & + & A_{l,m_l}(n+1)\cdots(n+m_l-1)\lambda_l^n
\end{matrix}$$</p>
<p>So far I have been unable to prove linear independence in full
generality; the main difficulty comes from handling roots with the
same argument. In certain special cases however the proof is not too
hard[^1]:</p>
<p><strong>Proposition.</strong> If $P_1,\ldots,P_l$ are polys and
$|\lambda_1|&lt;|\lambda_2|&lt;\ldots&lt;|\lambda_l|$ are complex numbers,
then the sequences $\{P_i(n)\lambda_i^n\}$ are linearly
independent. (Since the polys $1,\ n+1,\ (n+1)(n+2),\ \ldots$ are
linearly independent, this implies the $k$ initial conditions form a
basis.)</p>
<p><em>Proof.</em> Since polynomials are closed under multiplication by constants, it suffices to prove that the sum $\sum_i P_i(n)\lambda_i^n$ is always a nonzero sequence. WLOG we can assume $P_l(n)\neq0$; for sufficiently large $n$ we have</p>
<p>$$\begin{align*}
|P_l(n)\lambda_l^n|&&gt; c(l-1)|\lambda_l^n|\quad\text{for some constant $c&gt;0$} \\
&=c|\lambda_1|^n\left|\lambda_l\over\lambda_1\right|^n+\ldots+c|\lambda_{l-1}|^n\left|\lambda_l\over\lambda_{l-1}\right|^n \\
&&gt;c|\lambda_1|^n\left|P_1(n)\over c\right|+\ldots+c|\lambda_{l-1}|^n\left|P_{l-1}(n)\over c\right|\quad\text{since $\lambda_i/\lambda_1&gt;1$ for $1\le i&lt;l$} \\
&=|P_1(n)\lambda_1^n|+\ldots+|P_{l-1}(n)\lambda_{l-1}^n| \\
&\ge|P_1(n)\lambda_1^n+\ldots+P_{l-1}(n)\lambda_{l-1}^n|.
\end{align*}$$</p>
<p>Therefore, $-P_l(n)\lambda_l^n\neq
P_1(n)\lambda_1^n+\ldots+P_{l-1}(n)\lambda_{l-1}^n$ for sufficiently
large $n$. $\qed$</p>
<p>[^1]: The proof is highly reminiscent about a result I proved back in January about my so-called "strongly dominating chains" while finding the transcendence degree of $\hR/\R$.</p>
</body>
</html>
        
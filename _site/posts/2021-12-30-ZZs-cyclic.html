
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="/style.css"/>

<!-- Syntax highlighting -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
<script>hljs.highlightAll();</script>

<!-- JQuery -->
<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2"
        crossorigin="anonymous"></script>

<!-- MathJAX -->
<script>
  MathJax = {
    loader: {
	load: ['[custom]/xypic.js'],
	paths: {custom: 'https://cdn.jsdelivr.net/gh/sonoisa/XyJax-v3@3.0.1/build/'}
    },
    tex: {
	packages: {'[+]': ['xypic']},
	tags: 'ams',
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        macros: {
            A: '\\mathbb{A}', B: '\\mathbb{B}', C: '\\mathbb{C}', D: '\\mathbb{D}',
            E: '\\mathbb{E}', F: '\\mathbb{F}', G: '\\mathbb{G}', H: '\\mathbb{H}',
            I: '\\mathbb{I}', J: '\\mathbb{J}', K: '\\mathbb{K}', L: '\\mathbb{L}',
            M: '\\mathbb{M}', N: '\\mathbb{N}', O: '\\mathbb{O}', P: '\\mathbb{P}',
            Q: '\\mathbb{Q}', R: '\\mathbb{R}', S: '\\mathbb{S}', T: '\\mathbb{T}',
            U: '\\mathbb{U}', V: '\\mathbb{V}', W: '\\mathbb{W}', X: '\\mathbb{X}',
            Y: '\\mathbb{Y}', Z: '\\mathbb{Z}', RP: '\\mathbb{RP}', CP: '\\mathbb{CP}',

	    cA: '\\mathcal{A}', cB: '\\mathcal{B}', cC: '\\mathcal{C}', cD: '\\mathcal{D}',
            cE: '\\mathcal{E}', cF: '\\mathcal{F}', cG: '\\mathcal{G}', cH: '\\mathcal{H}',
            cI: '\\mathcal{I}', cJ: '\\mathcal{J}', cK: '\\mathcal{K}', cL: '\\mathcal{L}',
            cM: '\\mathcal{M}', cN: '\\mathcal{N}', cO: '\\mathcal{O}', cP: '\\mathcal{P}',
            cQ: '\\mathcal{Q}', cR: '\\mathcal{R}', cS: '\\mathcal{S}', cT: '\\mathcal{T}',
            cU: '\\mathcal{U}', cV: '\\mathcal{V}', cW: '\\mathcal{W}', cX: '\\mathcal{X}',
            cY: '\\mathcal{Y}', cZ: '\\mathcal{Z}',

	    fa: '\\mathfrak{a}', fb: '\\mathfrak{b}', fp: '\\mathfrak{p}', fm: '\\mathfrak{m}',
	    fM: '\\mathfrak{M}',

            bf: ['\\mathbf{#1}', 1], 
	    x: '\\mathbf{x}', y: '\\mathbf{y}', w: '\\mathbf{w}', Bb: '\\mathbf{b}',
	    i: '\\imath', j: '\\jmath', v: '\\mathbf{v}', w: '\\mathbf{w}',

	    a: '\\alpha', b: '\\beta', g: '\\gamma', e: '\\epsilon', l: '\\lambda',

	    id: '\\mathop{\\rm id}', span: '\\mathop{\\rm span}', im: '\\mathop{\\rm im}', sgn: '\\mathop{\\rm sgn}',
	    End: '\\mathop{\\rm End}', Gal: '\\mathop{\\rm Gal}', Hom: '\\mathop{\\rm Hom}', Inn: '\\mathop{\\rm Inn}',
	    Out: '\\mathop{\\rm Out}', spec: '\\mathop{\\rm Spec}', colim: '\\mathop{\\rm colim}', Ob: '\\mathop{\\rm Ob}',
	    Cn: '\\mathop{\\rm Cn}', Th: '\\mathop{\\rm Th}', Spec: '\\mathop{\\rm Spec}', halo: '\\mathop{\\rm halo}',
	    st: '\\mathop{\\rm st}', inte: '\\mathop{\\rm int}', trdeg: '\\mathop{\\rm tr.deg}', rank: '\\mathop{\\rm rank}',
	    nullity: '\\mathop{\\rm nullity}', Aut: '\\mathop{\\rm Aut}', ann: '\\mathop{\\rm ann}', max: '\\mathop{\\rm max}',
	    min: '\\mathop{\\rm min}', Re: '\\mathop{\\rm Re}', Im: '\\mathop{\\rm Im}', char: '\\mathop{\\rm char}',

	    Set: '\\mathbf{Set}', Top: '\\mathbf{Top}', HTop: '\\mathbf{HTop}', Grp: '\\mathbf{Grp}', Ab: '\\mathbf{Ab}',

  and: '\\quad\\text{and}\\quad', or: '\\quad\\text{or}\\quad',

	    nin: '\\not\\in', s: '\\subset', seq: '\\subseteq', ss: '\\supset', Seq: '\\supseteq',
	    inv: '{}^{-1}',
	    ol: '\\overline',
	    qed: '\\blacksquare',
	    hR: '{}^*\\R',
	    normal: '\\triangleleft', Normal: '\\triangleright',
	    normaleq: '\\trianglelefteq', Normaleq: '\\trianglerighteq',
	    dlim: '\\varinjlim',
	    invlim: '\\varprojlim',
	    imp: '\\Rightarrow',
	    impd: '\\Leftarrow',
	    eq: ['\\begin{equation}#1\\end{equation}', 1],
	    ZZ: ['\\Z/{#1}\\Z', 1],
	    ZZs: ['(\\Z/{#1}\\Z)^*', 1],
	    legendre: ['\\left(\\frac{#1}{#2}\\right)', 2],
	    d: '\\mathop{}\\!\\mathrm{d}',
	    p: '\\partial',
	    pp: ['{\\p #1\\over\\p #2}', 2],
	    ppp: ['{\\p^2 #1\\over\\p #2\\p #3}', 3],
	    angles: ['\\langle{#1}\\rangle', 1],
	    norm: ['\\left\\Vert{#1}\\right\\Vert', 1],
	    floor: ['\\left\\lfloor{#1}\\right\\rfloor', 1],
	    ceil: ['\\left\\lceil{#1}\\right\\rceil', 1],
        },
    },
    chtml: {
	scale: 0.85,
	linebreaks: {
	    automatic: true
	}
    }
};
</script>

<script id="MathJax-script" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

</head>
<body>
<a href="/index.html">&lt; Back</a> 
<h1>$\ZZs{p^n}$ is cyclic</h1>
<p>A few days back someone in the math Discord mentioned that $\ZZs{p^n}$
is cyclic for all primes $&gt;2$, so I took it upon myself to prove it.</p>
<p>My first idea was to arrange the elements of $\ZZs{p^n}$ in a grid mod
$p^{n-1}$, as shown in Figure 1. This is possible because</p>
<p>$$(x,p^n)=1 \iff (x,p^{n-1})=1 \iff (x,%,p^{n-1}, p^{n-1})=1.$$</p>
<p>{% include figure.html src="mod27-mulgroup.svg"
alt="$\ZZs{27}$"
figno=1
caption="The elements of $\ZZs{27}$, arranged in rows mod 9. Note that
the first row consists of the elements of $\ZZs{p^{n-1}}$ and there
are $p$ rows." %}</p>
<p>Observe that the map sending $x\in\ZZs{p^n}$ to its column represents
a group homomorphism</p>
<p>$$\phi:\ZZs{p^n}\to\ZZs{p^{n-1}}.$$</p>
<p>The kernel is the first column, which forms an order $p$ subgroup
$H$.</p>
<p>Now, by induction $\ZZs{p^{n-1}}$ is cyclic and so has a generator $x$
with order</p>
<p>$$k=|\ZZs{p^{n-1}}|=p^{n-2}(p-1).$$</p>
<p>In the larger group $\ZZs{p^n}$, the power $x^k$ may not equal 1, but
it is guaranteed to lie in $H$, which is the first column. This
follows from the fact that $\phi$ is a homomorphism.</p>
<h4>Case 1</h4>
<p>If $x^k\neq1$, then $x^k\in H$ has order $p$, so $x$ has order
$pk=|\ZZs{p^n}|$. Therefore $x$ is also a generator for $\ZZs{p^n}$
and this immediately concludes it is cyclic.</p>
<h4>Case 2</h4>
<p>If $x^k=1$, then $x$ generates an order $k$ subgroup
$K\le\ZZs{p^n}$. Since $H=\ker\phi$, $K$ is isomorphic to
$\im,\phi=\ZZs{p^{n-1}}$ and $H,K$ intersect trivially, we have a
split exact sequence of groups</p>
<p>$$1\to H\to \ZZs{p^n}\to K\to 1,$$</p>
<p>so $\ZZs{p^n}$ is a semidirect product of $H$ and $K$. But $\ZZs{p^n}$
is abelian, so this semidirect product must be a direct product</p>
<p>$$H\times K \cong C_p\times C_{p^{n-2}(p-1)}.$$</p>
<p>For $n=2$ this direct product is also cyclic, so I shall assume
$n\ge3$. I then show this case leads to a contradiction, so
$\ZZs{p^n}$ being cyclic is the only remaining possibility. (As a
bonus, this shows that all generators of $\ZZs{p^{n-1}}$ are also
generators of $\ZZs{p^n}$ for $n\ge3$.)</p>
<p>First we determine the number of elements in $H\times K \cong
C_p\times C_{p^{n-2}(p-1)}$ with order 1 or $p$. I'll call these
<em>$p$-elements</em> for brevity; these are simply the elements with
order $p$, plus the identity. The $p$-elements are</p>
<ol>
<li>$(1,1)$</li>
<li>$(a,1)$, where $a$ has order $p$</li>
<li>$(1,b)$, where $b$ has order $p$</li>
<li>$(a,b)$, where $a,b$ have order $p$.</li>
</ol>
<p>In a cyclic group with order divisible by $p$, the number of order $p$
elements is $\varphi(p)$. Thus, the number of $p$-elements in the
aforementioned product is</p>
<p>$$1+2\varphi(p)+\varphi(p)^2 = (\varphi(p)+1)^2 = p^2.$$</p>
<p>Going back to $\ZZs{p^n}$, we see that if $x$ is a $p$-element in
$\ZZs{p^n}$, then $\phi(x)$ is also a $p$-element in
$\ZZs{p^{n-1}}$. Thus</p>
<p>$${\text{$p$-elements in $\ZZs{p^n}$}} \subseteq
\phi^{-1}{\text{$p$-elements of $\ZZs{p^{n-1}}$}}.$$</p>
<p>Since $\phi$ is surjective and its fibres have size $p$, the RHS has
order</p>
<p>$$p\cdot(\text{# $p$-elements in $\ZZs{p^{n-1}}$}) = p^2.$$</p>
<p>(The equality follows since $\ZZs{p^{n-1}}$ is assumed to be cyclic by
induction.) Supposing $\ZZs{p^n}\cong H\times K$, it follows that LHS
and RHS have the same order, so</p>
<p>$${\text{$p$-elements in $\ZZs{p^n}$}} =
\phi^{-1}{\text{$p$-elements of $\ZZs{p^{n-1}}$}}.$$</p>
<p>These sets are illustrated in Figure 2.</p>
<p>{% include figure.html src="mod27-mulgroup-pelements.svg"
alt="The $p$-elements of $\ZZs{27}$"
figno=2
caption="If $\ZZs{27}$ is not cyclic, then the 3-elements of $\ZZs{27}$ are precisely the elements which share the same column as 1, 4 or 7, which are the 3-elements in $\ZZs{9}$." %}</p>
<p>To complete the contradiction, I show that a certain element $a$ lies
in the latter set, but not the former set. This special element is
$p^{n-2}+1$.</p>
<p>First, observe that</p>
<p>$${1,,p^{n-1}+1,,2p^{n-1}+1,\ldots,,(p-1)p^{n-1}+1}$$</p>
<p>is an order $p$ cyclic subgroup of $\ZZs{p^n}$. In fact, it is $H$. In
particular, $a$ has order $p$ in $\ZZs{p^{n-1}}$. Since $\phi(a)=a$,
we easily conclude that $a$ lies in the latter set.</p>
<p>It remains to show that $a$ does not have order $p$ in $\ZZs{p^n}$. I
do so by deriving this general identity:</p>
<p><strong>Lemma.</strong> If $p&gt;2$ and $n\ge3$, then</p>
<p>$$a^p \equiv p^{n-1}+1 \mod p^n.$$</p>
<p><em>Proof.</em> We have</p>
<p>$$a^p = {p\choose p}p^{p(n-2)} + {p\choose p-1}p^{(p-1)(n-2)} + \ldots</p>
<ul>
<li>{p\choose 2}p^{2(n-2)} + {p\choose 1}p^{n-2} + {p\choose 0}.$$</li>
</ul>
<p>The terms have the form $n_k={p\choose k}p^{k(n-2)}$. For $2\le k\le
p-1$, we have $p\mid {p\choose k}$, so $p^{k(n-2)+1}\mid n_k$. Now, we
have $k(n-2)+1\ge n$ for $k\ge 2$, so the $n_k$'s can be cancelled out
mod $p^n$. This leaves us with</p>
<p>$$a^p \equiv {p\choose p}p^{p(n-2)} + {p\choose 1}p^{n-2} + {p\choose
0} \equiv p^{p(n-2)} + p^{n-1} + 1 \mod p^n.$$</p>
<p>The first term can be cancelled out when $p&gt;2$ and $n\ge3$, since
$p(n-2)\ge 3n-6\ge n$, implying $p^n\mid p^{p(n-2)}$. $\qed$</p>
<p>The lemma shows that $a^p\not\equiv 1$ mod $p^n$, which completes the
proof by contradiction.</p>
<p>Note the lemma only holds for odd primes. In fact $\ZZs{2^n}$ is
easily seen to be not cyclic, because we can exhibit multiple order 2
elements, namely $-1$, $2^{n-1}-1$ and $2^{n-1}+1$. Additionally, I'll
prove that the residue 3 has order $2^{n-2}$, which will be sufficient
to characterise $\ZZs{2^n}$ as the product $C_2\times
C_{2^{n-2}}$. (This makes use of the fact that finite abelian groups
are products of cyclic groups.)</p>
<p><strong>Lemma.</strong> In $\ZZs{2^n}$, the residue 3 has order $2^{n-2}$.</p>
<p><em>Proof.</em> This can be manually seen for $n=2,3,4$, so suppose $n&gt;4$ and
that 3 has order $2^{n-3}$ in $\ZZs{2^{n-1}}$.</p>
<p>By the implication $3^k\equiv 1\bmod 2^n \imp 3^k\equiv 1\bmod
2^{n-1}$, we have that the order in $\ZZs{2^n}$ is a multiple of
$2^{n-3}$, the order in $\ZZs{2^{n-1}}$. Furthermore, the order must
be a proper divisor of $\bars{\ZZs{2^n}}=2^{n-1}$ since $\ZZs{2^n}$ is
not cyclic. This forces the orders to be either $2^{n-3}$ or
$2^{n-2}$. Thus it suffices to show that</p>
<p>$$3^{2^{n-3}}\not\equiv 1\bmod 2^n.$$</p>
<p>Before we do the calculations, first observe that
$3^{2^{n-4}}=2^{n-2}k+1$ for some $k$ since $3^{2^{n-4}}\equiv
1\bmod 2^{n-2}$. Furthermore, $2\nmid k$ because otherwise one can
conclude $3^{2^{n-4}}\equiv 1\bmod 2^{n-1}$ which we already know is
false.</p>
<p>Now, we have</p>
<p>$$\begin{align*}
3^{2^{n-3}}-1 &amp;= (3-1)\left(3^{2^{n-3}-1}+\cdots+3^{2^{n-4}}+3^{2^{n-4}-1}+\cdots+3^0\right) \<br />
&amp;= 2\left[\left(\sum_{i=0}^{2^{n-4}-1} 2^{n-2}(3^i k) + 3^i\right) + \sum_{i=0}^{2^{n-4}-1} 3^i\right] \<br />
&amp;= 2\left[2^{n-2}k\frac{3^{2^{n-4}}-1}{2} + 3^{2^{n-4}}-1\right] \<br />
&amp;= 2\left[2^{2n-5}k^2 + 2^{n-2}k\right] \<br />
&amp;\equiv 2^{n-1}k \<br />
&amp;\not\equiv 0 \bmod 2^n.\quad\qed
\end{align*}$$</p>
</body>
</html>
        